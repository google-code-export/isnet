ALTER TABLE MESSAGE
 DROP PRIMARY KEY CASCADE;
DROP TABLE MESSAGE CASCADE CONSTRAINTS;

CREATE TABLE MESSAGE
(
  MESSAGE_ID           NUMBER(19)               NOT NULL,
  REF_MESSAGE_ID       NUMBER(19),
  CREATED_TIME         TIMESTAMP(6)             NOT NULL,
  SENDER_ID            NUMBER(19)               NOT NULL,
  OWNER_ID             NUMBER(19)               NOT NULL,
  SUBJECT              VARCHAR2(300 CHAR)       NOT NULL,
  BODY                 VARCHAR2(2000 CHAR)      NOT NULL,
  STATUS               VARCHAR2(10 CHAR)        NOT NULL,
  READ_STATUS          VARCHAR2(10 CHAR)        NOT NULL,
  RECORD_CREATOR_ID    VARCHAR2(100 CHAR),
  RECORD_UPDATER_ID    VARCHAR2(100 CHAR),
  RECORD_CREATED       TIMESTAMP(6),
  RECORD_LAST_UPDATED  TIMESTAMP(6)
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


ALTER TABLE MESSAGE ADD (
  PRIMARY KEY
 (MESSAGE_ID));


ALTER TABLE MESSAGE ADD (
  CONSTRAINT FK63B68BE7340AEFBA 
 FOREIGN KEY (SENDER_ID) 
 REFERENCES MEMBER (MEMBER_ID));


ALTER TABLE MESSAGE_RECEIVER
 DROP PRIMARY KEY CASCADE;
DROP TABLE MESSAGE_RECEIVER CASCADE CONSTRAINTS;

CREATE TABLE MESSAGE_RECEIVER
(
  MESSAGE_ID          NUMBER(19)                NOT NULL,
  RECEIVER_MEMBER_ID  NUMBER(19)                NOT NULL
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


ALTER TABLE MESSAGE_RECEIVER ADD (
  PRIMARY KEY
 (MESSAGE_ID, RECEIVER_MEMBER_ID));


ALTER TABLE MESSAGE_RECEIVER ADD (
  CONSTRAINT FK_MESSAGE_MESSAGE_RECEIVER 
 FOREIGN KEY (MESSAGE_ID) 
 REFERENCES MESSAGE (MESSAGE_ID)
    ON DELETE CASCADE);

ALTER TABLE MESSAGE_RECEIVER ADD (
  CONSTRAINT FKBB91F3471FA0EEE5 
 FOREIGN KEY (RECEIVER_MEMBER_ID) 
 REFERENCES MEMBER (MEMBER_ID));



ALTER TABLE MESSAGE_ATTACHMENT
 DROP PRIMARY KEY CASCADE;
DROP TABLE MESSAGE_ATTACHMENT CASCADE CONSTRAINTS;

CREATE TABLE MESSAGE_ATTACHMENT
(
  ATTACHMENT_ID  NUMBER(19)                     NOT NULL,
  FILEPATH       VARCHAR2(255 CHAR),
  FILENAME       VARCHAR2(255 CHAR),
  MESSAGE_ID     NUMBER(19)
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


ALTER TABLE MESSAGE_ATTACHMENT ADD (
  PRIMARY KEY
 (ATTACHMENT_ID));


ALTER TABLE MESSAGE_ATTACHMENT ADD (
  CONSTRAINT FK_MESSAGE_MESSAGE_ATTACHMENT 
 FOREIGN KEY (MESSAGE_ID) 
 REFERENCES MESSAGE (MESSAGE_ID)
    ON DELETE CASCADE);



ALTER TABLE KNOWN_MEMBER
 DROP PRIMARY KEY CASCADE;
DROP TABLE KNOWN_MEMBER CASCADE CONSTRAINTS;

CREATE TABLE KNOWN_MEMBER
(
  KNOWN_ID         NUMBER(19)                   NOT NULL,
  KNOWN_MEMBER_ID  NUMBER(19)                   NOT NULL,
  MEMBER_ID        NUMBER(19)
)
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


ALTER TABLE KNOWN_MEMBER ADD (
  PRIMARY KEY
 (KNOWN_ID));


ALTER TABLE KNOWN_MEMBER ADD (
  CONSTRAINT FK_KNOWN_MEMBER_MEMBER 
 FOREIGN KEY (MEMBER_ID) 
 REFERENCES MEMBER (MEMBER_ID));

ALTER TABLE KNOWN_MEMBER ADD (
  CONSTRAINT FK_KNOWN_MEMBER_KNOW_ABOUT
 FOREIGN KEY (KNOWN_MEMBER_ID) 
 REFERENCES MEMBER (MEMBER_ID));


DROP SEQUENCE ATTACHMENT_ID_SEQ;

CREATE SEQUENCE ATTACHMENT_ID_SEQ
  START WITH 41
  MAXVALUE 999999999999999999999999999
  MINVALUE 1
  NOCYCLE
  CACHE 20
  NOORDER;
  

DROP SEQUENCE KNOWN_MEMBER_ID_SEQ;

CREATE SEQUENCE KNOWN_MEMBER_ID_SEQ
  START WITH 161
  MAXVALUE 999999999999999999999999999
  MINVALUE 1
  NOCYCLE
  CACHE 20
  NOORDER;  
  

DROP SEQUENCE MESSAGE_ID_SEQ;

CREATE SEQUENCE MESSAGE_ID_SEQ
  START WITH 161
  MAXVALUE 999999999999999999999999999
  MINVALUE 1
  NOCYCLE
  CACHE 20
  NOORDER;
  