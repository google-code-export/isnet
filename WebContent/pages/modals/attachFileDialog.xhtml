<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jstl/core">
	<ui:composition>

		<rich:modalPanel id="idAttachDialog" minHeight="200" minWidth="400" autosized="true">
			<f:facet name="header"><h:outputText value="Attach File"/></f:facet>
			<f:facet name="controls">
              	<h:graphicImage value="/images/close.png" style="cursor:pointer" onclick="Richfaces.hideModalPanel('idAttachDialog')" />
       		</f:facet>

            <a4j:form id="attachFileForm" >
            <c:set var="uploadBean" value="#{messageHanlder.attachmentHandler}"/>

				<rich:panel styleClass="popup_window_outer_panel_style" id="idPopupPanel">
					

	              <rich:fileUpload listHeight="150px" listWidth="390px" fileUploadListener="${uploadBean.listener}"
	                maxFilesQuantity="${uploadBean.uploadsAvailable}"
	                immediateUpload="${uploadBean.autoUpload}" 
	                allowFlash="${uploadBean.useFlash}">
	                
	                <a4j:support event="onuploadcomplete" 
	                  action="#{messageHanlder.attachFile}" reRender="idAttachmentTable,idResultPanel"
	                  oncomplete="Richfaces.hideModalPanel('idAttachDialog')"/>                
	               </rich:fileUpload>					



				</rich:panel>
			</a4j:form>							
		</rich:modalPanel>
	
	</ui:composition>
</html>
